CHD Intervention
================

I have defined two simulations: one with no interventions (the business as
usual scenario, BAU) and one where CHD incidence is reduced by 5%. These are
defined in `test_dis.yaml` and `test_dis_interv.yaml`, respectively, and they
write output to `test_dis.csv` and `test_dis_interv.csv`, respectively.

When you run the simulation with the intervention, it will print out the state
of the CHD model before and after each time-step **for those males aged 2 in
2010**. This will look like:

    age               Healthy         Diseased             Dead  Mort Risk
        ACMR      0.000200000 +    0.000000000 =    0.000200000
      2  BAU   1000.000000000      0.000000000      0.000000000  0.0000e+00
         INT   1000.000000000      0.000000000      0.000000000  0.0000e+00
        ACMR      0.000200000 +    0.000000000 =    0.000200000
      3  BAU   1000.000000000      0.000000000      0.000000000  0.0000e+00
         INT   1000.000000000      0.000000000      0.000000000  0.0000e+00
        ACMR      0.000170000 +    0.000000000 =    0.000170000
      3  BAU   1000.000000000      0.000000000      0.000000000  0.0000e+00
         INT   1000.000000000      0.000000000      0.000000000  0.0000e+00
        ACMR      0.000170000 +    0.000000000 =    0.000170000
      4  BAU   1000.000000000      0.000000000      0.000000000  0.0000e+00
         INT   1000.000000000      0.000000000      0.000000000  0.0000e+00
        ACMR      0.000140000 +    0.000000000 =    0.000140000
      4  BAU   1000.000000000      0.000000000      0.000000000  0.0000e+00
         INT   1000.000000000      0.000000000      0.000000000  0.0000e+00
        ACMR      0.000140000 +    0.000000000 =    0.000140000
    ...

- Lines with `ACMR` show the baseline mortality rate, the change in mortality
  rate due to the intervention, and the resulting intervention mortality rate.

- Lines with `BAU` show the CHD model state without the intervention.

- Lines with `INT` show the CHD model state with the intervention.

- The `BAU` and `INT` lines are printed both **before and after** each
  time-step.

- The `ACMR` line is printed when `Disease.mortality_adjustment()` is called.
  Note that it appears to be called **twice** for each time-step; I am unsure
  why this is the case.

These outputs should match the data in `chd_pif_0.95_males.ods`, which was
obtained from Anja's spreadsheet model, and the DALE for this cohort should be
69.26 (up from 69.17), as generated by Anja in `tobacco_model_pif_test.ods`.

What doesn't match?
===================

Overall DALE
------------

This cohort has a DALE of 70.02 (see the row in `test_dis_interv.csv` that
starts with `2008,male,2,2010`), not 69.26; the intervention is having too
large an effect.

BAU mortality rate
------------------

The BAU mortality rate, as printed in the `ACMR` lines, appears to deviate
from that provided in the input file (`./data/inputs_take2.csv`) once the
intervention begins to have an effect (when the cohort reach age 20):

    ACMR      0.000790300 +    0.000000000 =    0.000790300
    ACMR      0.000870400 +    0.000000000 =    0.000870400
    ACMR      0.000871831 +   -0.000000072 =    0.000871759
    ACMR      0.000891831 +   -0.000000072 =    0.000891759
    ACMR      0.000894438 +   -0.000000202 =    0.000894236
    ACMR      0.000854438 +   -0.000000202 =    0.000854236

The BAU ACMRs should be: 0.0007903, 0.0008704, 0.0008904, 0.0008504 (and
remember that this `ACMR` line is printed twice for each time-step).

Mortality risks
---------------

The mortality risks are also one year behind those listed in the spreadsheet
model:

    20  BAU    999.980966181      0.019033819      0.000000000  0.0000e+00
        INT    999.981917863      0.018082137      0.000000000  0.0000e+00
    20  BAU    999.947941355      0.050628037      0.001430608  1.4306e-06
        INT    999.950544223      0.048096699      0.001359078  1.3591e-06
    21  BAU    999.947941355      0.050628037      0.001430608  1.4306e-06
        INT    999.950544223      0.048096699      0.001359078  1.3591e-06
    21  BAU    999.895652445      0.098878615      0.005468940  4.0383e-06
        INT    999.900869564      0.093934937      0.005195499  3.8364e-06
    22  BAU    999.895652445      0.098878615      0.005468940  4.0383e-06
        INT    999.900869564      0.093934937      0.005195499  3.8364e-06

In the spreadsheet, the mortality risks 1.4306e-06 and 1.3591e-06 are obtained
when this cohort is aged 19, not when aged 20.
